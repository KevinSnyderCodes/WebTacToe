<!DOCTYPE html>
<html>

<head>
  <title>3x3 Table</title>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

  <style>
    .center {
      margin: 0 auto;
      text-align: center;
    }

    td {
      border: 1px solid black;
      width: 50px;
      height: 50px;

      padding: 10px;
    }
  </style>
  
</head>

<body>

  <table class="center">
    <tr>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <td>7</td>
      <td>8</td>
      <td>9</td>
    </tr>
  </table>

  <div class="center">
    <input type="button" id="reset" value="Reset" />
    <p id="time">0</p>
  </div>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

  <script>
    var turn = false;
    var started = false;
    var stop = true;
    var numClicked = 0;
    $("td").on('click', function() {
      if (!started) {
        stop = false;
        started = true;
        runTimer();
      }
      if (!$(this).hasClass("clicked")) {
        turn = !turn;
        numClicked++;
        if (turn) $(this).css("background-color", "red");
        else $(this).css("background-color", "blue");
        $(this).addClass("clicked");  
      }
      if (numClicked == 9) stop = true;
    });

    var t = 0;
    function runTimer() {
      if (!stop) {
        $("#time").text(t);
        t++;
        window.setTimeout(runTimer, 1000);
      }
    }

    function reset() {
      turn = false;
      started = false;
      stop = true;
      numClicked = 0;
      $("td").css("background-color", "white").removeClass("clicked");
      t = 0;
      $("#time").text(t);
    }
    $("#reset").on('click', reset);

    /*function async(fn, callback) {
      setTimeout(function() {
        fn();
        if (callback) callback();
      }, 0);
    }*/
  </script>
</body>
</html>
